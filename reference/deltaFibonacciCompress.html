<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Use a lossy delta-Fibonacci (de)compression to continuous 8-bit signals.
This algorithm was used to compress 8-bit audio wave data on the Amiga."><title>(De)compress 8-bit continuous signals. — deltaFibonacciCompress • AmigaFFH</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="(De)compress 8-bit continuous signals. — deltaFibonacciCompress"><meta property="og:description" content="Use a lossy delta-Fibonacci (de)compression to continuous 8-bit signals.
This algorithm was used to compress 8-bit audio wave data on the Amiga."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">AmigaFFH</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../reference/AmigaFFH-package.html">Package documentation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pepijn-devries/AmigaFFH/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>(De)compress 8-bit continuous signals.</h1>
      <small class="dont-index">Source: <a href="https://github.com/pepijn-devries/AmigaFFH/blob/HEAD/R/generic_support.r" class="external-link"><code>R/generic_support.r</code></a></small>
      <div class="d-none name"><code>deltaFibonacciCompress.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use a lossy delta-Fibonacci (de)compression to continuous 8-bit signals.
This algorithm was used to compress 8-bit audio wave data on the Amiga.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">deltaFibonacciCompress</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">deltaFibonacciDecompress</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>A <code>vector</code> of <code>raw</code> data that needs to be (de)compressed.</p></dd>


<dt>...</dt>
<dd><p>Currently ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a <code>vector</code> of the resulting (de)compressed <code>raw</code> data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This form of compression is lossy, meaning that information and quality will get lost.
8-bit audio is normally stored as an 8-bit signed value representing the amplitude
at specific time intervals. The delta-Fibonacci compression instead stores the
difference between two time intervals (delta) as a 4-bit index. This index in turn
represents a value from the Fibonacci series (hence the algorithm name). The compression
stores small delta values accurately, but large delta values less accurately.
As each sample is stored as a 4-bit value instead of an 8-bit value, the amount of
data is reduced with almost 50\<!-- % (the exact compression ratio is (4 + n)/(2n)). --></p>
<p>The algorithm was first described by Steve Hayes and was used in 8SVX audio stored in
the Interchange File Format (IFF). The quality loss is considerable (especially
when the audio contained many large deltas) and was even in
the time it was developed (1985) not used much. The function is provided here for
the sake of completeness. The implementation here only compresses 8-bit data, as
for 16-bit data the quality loss will be more considerable.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://en.wikipedia.org/wiki/Delta_encoding" class="external-link">https://en.wikipedia.org/wiki/Delta_encoding</a></p>
<p><a href="http://amigadev.elowar.com/read/ADCD_2.1/Devices_Manual_guide/node02D6.html" class="external-link">http://amigadev.elowar.com/read/ADCD_2.1/Devices_Manual_guide/node02D6.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Pepijn de Vries</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Let's get an audio wave from the ProTrackR package, which we</span></span></span>
<span class="r-in"><span><span class="co">## can use in this example:</span></span></span>
<span class="r-in"><span><span class="va">buzz</span>     <span class="op">&lt;-</span> <span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/PTSample-class.html" class="external-link">PTSample</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="va"><a href="https://pepijn-devries.github.io/ProTrackR/reference/mod.intro.html" class="external-link">mod.intro</a></span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's convert it into raw data, such that we can compress it:</span></span></span>
<span class="r-in"><span><span class="va">buzz.raw</span> <span class="op">&lt;-</span> <span class="fu">adfExplorer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adfExplorer/man/amigaIntToRaw.html" class="external-link">amigaIntToRaw</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">buzz</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, <span class="fl">8</span>, <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's compress it:</span></span></span>
<span class="r-in"><span><span class="va">buzz.compress</span> <span class="op">&lt;-</span> <span class="fu">deltaFibonacciCompress</span><span class="op">(</span><span class="va">buzz.raw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Look the new data uses less memory:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">buzz.compress</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">buzz.raw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The compression was lossy, which we can examine by decompressing the</span></span></span>
<span class="r-in"><span><span class="co">## sample again:</span></span></span>
<span class="r-in"><span><span class="va">buzz.decompress</span> <span class="op">&lt;-</span> <span class="fu">deltaFibonacciDecompress</span><span class="op">(</span><span class="va">buzz.compress</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## And turn the raw data into numeric data:</span></span></span>
<span class="r-in"><span><span class="va">buzz.decompress</span> <span class="op">&lt;-</span> <span class="fu">adfExplorer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adfExplorer/man/rawToAmigaInt.html" class="external-link">rawToAmigaInt</a></span><span class="op">(</span><span class="va">buzz.decompress</span>, <span class="fl">8</span>, <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot the original wave in black, the decompressed wave in blue</span></span></span>
<span class="r-in"><span><span class="co">## and the error in red (difference between the original and decompressed</span></span></span>
<span class="r-in"><span><span class="co">## wave). The error is actually very small here.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">buzz</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">buzz.decompress</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">buzz.error</span> <span class="op">&lt;-</span> <span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">buzz</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span> <span class="op">-</span> <span class="va">buzz.decompress</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">buzz.error</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## this can also be visualised by plotting the orignal wave data against</span></span></span>
<span class="r-in"><span><span class="co">## the decompressed data (and observe a very good correlation):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">buzz</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, <span class="va">buzz.decompress</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's do the same with a sample of a snare drum, which has larger</span></span></span>
<span class="r-in"><span><span class="co">## delta values:</span></span></span>
<span class="r-in"><span><span class="va">snare.drum</span> <span class="op">&lt;-</span> <span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/PTSample-class.html" class="external-link">PTSample</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="va"><a href="https://pepijn-devries.github.io/ProTrackR/reference/mod.intro.html" class="external-link">mod.intro</a></span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's convert it into raw data, such that we can compress it:</span></span></span>
<span class="r-in"><span><span class="va">snare.raw</span> <span class="op">&lt;-</span> <span class="fu">adfExplorer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adfExplorer/man/amigaIntToRaw.html" class="external-link">amigaIntToRaw</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">snare.drum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, <span class="fl">8</span>, <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Let's compress it:</span></span></span>
<span class="r-in"><span><span class="va">snare.compress</span> <span class="op">&lt;-</span> <span class="fu">deltaFibonacciCompress</span><span class="op">(</span><span class="va">snare.raw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Decompress the sample:</span></span></span>
<span class="r-in"><span><span class="va">snare.decompress</span> <span class="op">&lt;-</span> <span class="fu">deltaFibonacciDecompress</span><span class="op">(</span><span class="va">snare.compress</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## And turn the raw data into numeric data:</span></span></span>
<span class="r-in"><span><span class="va">snare.decompress</span> <span class="op">&lt;-</span> <span class="fu">adfExplorer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/adfExplorer/man/rawToAmigaInt.html" class="external-link">rawToAmigaInt</a></span><span class="op">(</span><span class="va">snare.decompress</span>, <span class="fl">8</span>, <span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now if we make the same comparison as before, we note that the</span></span></span>
<span class="r-in"><span><span class="co">## error in the decompressed wave is much larger than in the previous</span></span></span>
<span class="r-in"><span><span class="co">## case (red line):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">snare.drum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">snare.decompress</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">snare.error</span> <span class="op">&lt;-</span> <span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">snare.drum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span> <span class="op">-</span> <span class="va">snare.decompress</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">snare.error</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## this can also be visualised by plotting the orignal wave data against</span></span></span>
<span class="r-in"><span><span class="co">## the decompressed data (and observe a nice but not perfect correlation):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot.html">plot</a></span><span class="op">(</span><span class="fu">ProTrackR</span><span class="fu">::</span><span class="fu"><a href="https://pepijn-devries.github.io/ProTrackR/reference/waveform.html" class="external-link">waveform</a></span><span class="op">(</span><span class="va">snare.drum</span><span class="op">)</span> <span class="op">-</span> <span class="fl">128</span>, <span class="va">snare.decompress</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pepijn de Vries.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

